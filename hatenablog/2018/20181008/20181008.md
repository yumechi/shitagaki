Conohaと戯れてみる
==================

仕事ではサーバーサイドのエンジニアとして働いているが、普段は完全に構築されて切った環境でぬくぬくと開発していることもあり、OS並びにミドルウェア、そしてWebAPIを構成する技術要素全般についてもう少し理解を深めるべきだと思った。

そこでVPSでも借りて遊んでみることにした。

選択肢としてはAWSとか、GCPとかあったけど、なんとなくConohaにした。キャラクターが可愛いっていうのもあるけど、普段自分が開発する範囲では、そのへんにある開発マシンをいじっていたりすることも多いので、その環境に近い感じにしておいた。

物理マシンのサーバーを用意してやるのも選択肢ではあったけど、正直直近少しいじって見るだけだとサーバー用になにか買うのもコスト的にもったいないなとは思っていて、勉強するにしてもどっか借りる気ではいた。

次に触るとしたらAWSかなーとは思う。でもEC2触るだけだと味気ないので、何かと組み合わせられないと考えにくいかなと。

暇があったら物理的なサーバー立ててなんかするのもいいかなーとは思うけど、その頃にはもっとVPSでやれるサーバーが一般的になってそうだなーとか。

契約周りとか
------------

公式ページに沿ってセットアップ。メモリ1GB、ディスク50GBのやつにした。月額980円ってすごいな？
OSはCentOS7系の最新版。

ディスク意外とついてくるなという印象。

<https://www.conoha.jp/guide/study-02.php>

とはいえ、若干インターフェースは変わってるのでよく読んだほうが良さそうかも。

SSH Confする
------------

この辺全く知らなかったので、勉強になった。

これを参考にした。というかほぼこれ。

<https://qiita.com/ongaeshi/items/bb17ebfbd4d22057c8fd>

やることとしてはユーザーを作って、 `/etc/ssh/sshd_config`
を編集していく。
PasswordAuthとか、Challengeとかを無効にしつつ、SSH認証するようにする。

鍵を作ったり受け渡したりしてログインするところは普段、よしなに登録してもらっているので理解があんまりできておらず
、新鮮でした。

### 他に参考にしたところとか

大体 SSH Config系統。

-   <http://tkm-71.hatenablog.com/entry/2016/03/20/153825>

-   <https://gentoo.reichsarchiv.jp/item/17>

-   <https://dogmap.jp/2011/10/27/ssh_config/>

-   <http://www.kmiura.net/archives/8619663.html>

ndf を導入する
--------------

yum に変わる新しいパッケージマネージャーとして dnf
というものが存在する。これを入れていく。 参考にした記事はこちら。

-   <http://www.trapping.xyz/2018/01/centos7dnf.html>

-   <https://qiita.com/skanno/items/7ac41c7e6a12bcfcfed3>

ちなみに `yum install dnf` で入らなかったので wget
でパッケージを取ってきてインストールした。

使い勝手はそんなに変わらないような気がする。

git を導入する
--------------

これは流石に常識として理解していたが `yum` や `apt` ではいる git
は本当にバージョンが古い。なので、ビルドする。

公式のドキュメントだけでOK。てか公式のドキュメント、 dnf
でしか書いてない。はい、という感じだ。

<https://git-scm.com/book/en/v2/Getting-Started-Installing-Git>

（これは仕事とかでも何回かビルドしたことがあったので、楽勝だった…）

ちなみにCentOSは `db2x_docbook2texi`
のシンボリックリンクをはらないとだめです。

Dockerを入れる
--------------

公式ドキュメントに従う。

<https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-repository>

リポジトリの追加方法を調べるのがめんどくさくなってしまって、ここは yum
でリポジトリ追加してしまった。 反省しましょう。

あとは docker グループにユーザー追加したりした。下記を見た。

<https://qiita.com/inakadegaebal/items/be9fecce813cebec5986>

ついでにDocker Composeも入れる。

<https://docs.docker.com/compose/install/#install-compose>

他に参考にしたところとか
------------------------

-   Dockerの不要なコンテナ・イメージを一括削除する方法

    -   <https://suin.io/537>

    -   テストで作ったhello, worldのやつとか消すときに使った

一旦の感想
----------

色々入れてビルドしていくだけでも結構楽しいなってなってしまってヤバイ。まだ何もできていないんですが…
。（Dockerで開発環境をまとめるとか、そういうのもやっていかないといけないんだよね、これから）

話が長くなってしまうので、ここで一旦切るけど、実際に手で色々入れてみるのは、トラブったときに何が違うんだろう
、あっここだ！みたいな発見を延々としていき、学びがあった。

続きはDocker入れようとしてうまくいかない話とか、Shell入れる話とかGcc入れてみましたみたいな話が続くので、翌日以降に書いていこうと思います

VPSでいろいろするの楽しいなーってなったので、これからもちょいちょいいじっていこうかな。なにかうまく作れたら公開できるといいなあとかもある。

ひとまずはPHPで遊びたいなと思っているのでLaravelでもいれて遊ぼうかなと思っていたので、頑張ろう。
